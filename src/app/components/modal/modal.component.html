<div class="modal-wrapper" [class.keyboard-open]="isKeyboardOpen" [class.inputs-filled]="areInputsFilled">
  <div class="handle"></div>
  <div class="modal-content">
    <div class="scrollable-content">
      <div class="input-group">
        <div class="input-wrapper">
          <ion-searchbar 
            class="animated-input"
            [placeholder]="'MODAL.whereAreYou' | translate"
            [ngModel]="pickupInput"
            (ngModelChange)="onPickupInputChange($event)"
            (ionFocus)="onFocus($event, 'pickup')"
            (ionBlur)="onBlur($event)"
            (ionClear)="clearInput('pickup')"
            showCancelButton="never"
            cancelButtonText="Clear">
          </ion-searchbar>
          <div *ngIf="!pickupInput" class="icon-wrapper" (click)="clearInput('pickup')">
            <ion-icon 
              [color]="isLocationFetched ? 'success' : 'medium'"
              name="location-outline"
              class="location-icon">
            </ion-icon>
          </div>
        </div>
        <div class="input-wrapper">
          <ion-searchbar 
            class="animated-input"
            [placeholder]="'MODAL.whereTo' | translate"
            [ngModel]="destinationInput"
            (ngModelChange)="onDestinationInputChange($event)"
            (ionFocus)="onFocus($event, 'destination')"
            (ionBlur)="onBlur($event)"
            (ionClear)="clearInput('destination')"
            showCancelButton="never"
            cancelButtonText="Clear">
          </ion-searchbar>
          <div *ngIf="!destinationInput" class="icon-wrapper" (click)="clearInput('destination')">
            <ion-icon 
              name="location-outline"
              class="location-icon">
            </ion-icon>
          </div>
        </div>

        <div *ngIf="pickupInput && destinationInput" class="vehicle-selection">
          <!-- Loading State -->
          <div *ngIf="isLoadingServices" class="vehicle-loading">
            <ion-spinner></ion-spinner>
            <p>Loading vehicle options...</p>
          </div>

          <!-- Vehicle List -->
          <div *ngIf="!isLoadingServices && vehicleServices" class="vehicle-list-container">
            <ion-list>
              <ion-radio-group name="auto" [(ngModel)]="selectedVehicle" (ionChange)="onVehicleSelect($event)" class="vehicle-radio-group">
                <!-- Cerca Small -->
                <ion-item *ngIf="vehicleServices.cercaSmall?.enabled" lines="none" class="vehicle-item">
                  <ion-avatar class="vehicle-avatar">
                    <img [src]="vehicleServices.cercaSmall?.imagePath || 'assets/cars/cerca-small.png'" alt="Cerca Small Vehicle" />
                  </ion-avatar>
                  <ion-radio value="small" class="vehicle-radio">
                    <div class="vehicle-info">
                      <div class="vehicle-header">
                        <span class="vehicle-name">{{ vehicleServices.cercaSmall?.name || ('MODAL.cercaSmall' | translate) }}</span>
                        <span class="vehicle-price">₹{{ vehicleServices.cercaSmall?.price || 299 }}</span>
                      </div>
                      <span class="vehicle-seats">{{ vehicleServices.cercaSmall?.seats || 4 }} {{ 'MODAL.seats' | translate }}</span>
                    </div>
                  </ion-radio>
                </ion-item>
                <!-- Cerca Medium -->
                <ion-item *ngIf="vehicleServices.cercaMedium?.enabled" lines="none" class="vehicle-item">
                  <ion-avatar class="vehicle-avatar">
                    <img [src]="vehicleServices.cercaMedium?.imagePath || 'assets/cars/Cerca-medium.png'" alt="Cerca Medium Vehicle" />
                  </ion-avatar>
                  <ion-radio value="medium" class="vehicle-radio">
                    <div class="vehicle-info">
                      <div class="vehicle-header">
                        <span class="vehicle-name">{{ vehicleServices.cercaMedium?.name || ('MODAL.cercaMedium' | translate) }}</span>
                        <span class="vehicle-price">₹{{ vehicleServices.cercaMedium?.price || 499 }}</span>
                      </div>
                      <span class="vehicle-seats">{{ vehicleServices.cercaMedium?.seats || 6 }} {{ 'MODAL.seats' | translate }}</span>
                    </div>
                  </ion-radio>
                </ion-item>
                <!-- Cerca Large -->
                <ion-item *ngIf="vehicleServices.cercaLarge?.enabled" lines="none" class="vehicle-item">
                  <ion-avatar class="vehicle-avatar">
                    <img [src]="vehicleServices.cercaLarge?.imagePath || 'assets/cars/cerca-large.png'" alt="Cerca Large Vehicle" />
                  </ion-avatar>
                  <ion-radio value="large" class="vehicle-radio">
                    <div class="vehicle-info">
                      <div class="vehicle-header">
                        <span class="vehicle-name">{{ vehicleServices.cercaLarge?.name || ('MODAL.cercaLarge' | translate) }}</span>
                        <span class="vehicle-price">₹{{ vehicleServices.cercaLarge?.price || 699 }}</span>
                      </div>
                      <span class="vehicle-seats">{{ vehicleServices.cercaLarge?.seats || 8 }} {{ 'MODAL.seats' | translate }}</span>
                    </div>
                  </ion-radio>
                </ion-item>
              </ion-radio-group>
            </ion-list>
          </div>

          <!-- Fallback if no services loaded -->
          <div *ngIf="!isLoadingServices && !vehicleServices" class="vehicle-fallback">
            <ion-list>
              <ion-radio-group name="auto" [(ngModel)]="selectedVehicle" (ionChange)="onVehicleSelect($event)" class="vehicle-radio-group">
                <ion-item lines="none" class="vehicle-item">
                  <ion-avatar class="vehicle-avatar">
                    <img src="assets/cars/cerca-small.png" alt="Cerca Small Vehicle" />
                  </ion-avatar>
                  <ion-radio value="small" class="vehicle-radio">
                    <div class="vehicle-info">
                      <div class="vehicle-header">
                        <span class="vehicle-name">{{ 'MODAL.cercaSmall' | translate }}</span>
                        <span class="vehicle-price">₹299</span>
                      </div>
                      <span class="vehicle-seats">4 {{ 'MODAL.seats' | translate }}</span>
                    </div>
                  </ion-radio>
                </ion-item>
                <ion-item lines="none" class="vehicle-item">
                  <ion-avatar class="vehicle-avatar">
                    <img src="assets/cars/Cerca-medium.png" alt="Cerca Medium Vehicle" />
                  </ion-avatar>
                  <ion-radio value="medium" class="vehicle-radio">
                    <div class="vehicle-info">
                      <div class="vehicle-header">
                        <span class="vehicle-name">{{ 'MODAL.cercaMedium' | translate }}</span>
                        <span class="vehicle-price">₹499</span>
                      </div>
                      <span class="vehicle-seats">6 {{ 'MODAL.seats' | translate }}</span>
                    </div>
                  </ion-radio>
                </ion-item>
                <ion-item lines="none" class="vehicle-item">
                  <ion-avatar class="vehicle-avatar">
                    <img src="assets/cars/cerca-large.png" alt="Cerca Large Vehicle" />
                  </ion-avatar>
                  <ion-radio value="large" class="vehicle-radio">
                    <div class="vehicle-info">
                      <div class="vehicle-header">
                        <span class="vehicle-name">{{ 'MODAL.cercaLarge' | translate }}</span>
                        <span class="vehicle-price">₹699</span>
                      </div>
                      <span class="vehicle-seats">8 {{ 'MODAL.seats' | translate }}</span>
                    </div>
                  </ion-radio>
                </ion-item>
              </ion-radio-group>
            </ion-list>
          </div>

          <div class="payment-button-container">
            <ion-button expand="block" class="payment-button" (click)="goToPayment()">
              <ion-icon name="card-outline" slot="start"></ion-icon>
              {{ 'MODAL.proceedToPayment' | translate }}
            </ion-button>
          </div>
        </div>
      </div>

      <!-- <div class="address-chips-container" *ngIf="!areInputsFilled">
        <div class="address-chips">
          <div 
            *ngFor="let address of addresses" 
            class="chip"
            [class.selected]="address.isSelected"
            (click)="toggleAddress(address)">
            <span class="chip-type">{{address.type}}</span>
            <span class="chip-address">{{address.address}}</span>
          </div>
        </div>
      </div> -->
    </div>
  </div>
</div>
